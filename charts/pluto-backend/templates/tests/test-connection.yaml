# charts/pluto-backend/templates/tests/test-connection.yaml
apiVersion: v1
kind: Pod
metadata:
  name: {{ include "pluto-backend.fullname" . }}-test-connection
  labels:
    app.kubernetes.io/name: {{ include "pluto-backend.name" . }}
    app.kubernetes.io/instance: {{ .Release.Name }}
  annotations:
    "helm.sh/hook": test-success
spec:
  restartPolicy: Never
  containers:
    - name: wget
      image: busybox:1.35.0
      command: ["wget"]
      args:
        # проверяем /health вашего manifest-сервиса
        - "-qO-"
        - "http://{{ include "pluto-backend.fullname" . }}-manifest:{{ .Values.manifest.port }}/health"
